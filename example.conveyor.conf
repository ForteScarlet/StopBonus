// StopBonus - Conveyor 配置示例（模板）
//
// 目标：
// - 在现有 `conveyor.conf` 的思路基础上，把常用/可定制的配置点按平台补齐并加上说明；
// - 本文件用于“参考与复制”，不建议直接替换线上使用的 `conveyor.conf`。
//
// 说明：
// - Conveyor 配置使用 HOCON（支持 `//` 注释、层级对象、`+=` 追加等）。
// - 本项目当前通过 Gradle 插件动态注入 JDK/Compose/inputs 等片段：
//   `include "#!./gradlew --console=plain --quiet printConveyorConfig"`
//   这样可以避免把大量“绝对路径依赖”提交进仓库。
// - CI 额外的敏感信息（如签名密钥）建议放到单独文件（例如 `ci.conveyor.conf`）用环境变量注入。

// -----------------------------------------------------------------------------
// 0) 由 Gradle/Compose 插件动态生成并注入的片段（强烈建议保留）
// -----------------------------------------------------------------------------
//
// 该片段通常会包含：
// - `include required("/stdlib/jdk/...")`：选择要打包进应用的 JDK 发行版/版本
// - `app.jvm.gui.main-class`：入口 main class
// - `app.inputs` 及各平台/架构的 inputs：JAR + 依赖 + Skiko 等运行时
// - `app.version`、`app.vendor`、`app.description` 等（来自 Gradle/Compose 配置）
//
include "#!./gradlew --console=plain --quiet printConveyorConfig"

// -----------------------------------------------------------------------------
// 1) 可选：native library 预提取（例如 Skiko）
// -----------------------------------------------------------------------------
//
// 这会把常见 native library 预先释放到 JVM lib 目录，减少启动期失败概率并提升启动速度。
// 如不需要可移除该 include。
//
include file("conveyor/extract-native-libraries.conf")

// -----------------------------------------------------------------------------
// 2) Conveyor 自身配置
// -----------------------------------------------------------------------------
//
// compatibility-level 用于保持对旧版本 Conveyor 的兼容（模板默认值）。
// 如果你新增了依赖某个更高版本的特性，可视情况提升该值。
//
conveyor.compatibility-level = 18

// -----------------------------------------------------------------------------
// 3) 应用元数据与通用配置（app { ... }）
// -----------------------------------------------------------------------------
app {
  // 用户可见名称（安装器/菜单显示名）。
  display-name = "StopBonus"

  // 文件系统名：Conveyor 要求必须是 kebab-case（小写字母/数字/连字符）。
  // ⚠️ 一旦发布给用户后不建议随意修改，否则可能导致：
  // - 更新链断裂（被视为“另一个应用”）
  // - 安装目录/缓存目录变化
  fsname = stopbonus

  // 反向域名（唯一标识）。
  // 建议显式写死，避免未来改 `fsname` 时 rdns 跟着变化导致断更/断升级。
  rdns-name = "love.forte.bonus.StopBonus"

  // 版本号：通常由 Gradle 插件注入（`app.version = ...`）。
  // 若要在不经 Gradle 的情况下单独运行 Conveyor，可显式指定。
  //
  // version = "1.0.0"

  // 元信息：通常也会由 Gradle/Compose 注入，可在这里显式覆盖。
  //
  // vendor = "Forte Scarlet"
  // description = "DO NOT BONUS YOURSELF!"

  // 开源/项目地址（用于站点/元信息展示）。
  vcs-url = "https://github.com/ForteScarlet/StopBonus"

  // -----------------------------
  // 更新站点（site.*）
  // -----------------------------
  //
  // `site.base-url` 是更新检查与下载站点的根地址（通常是 GitHub Pages）。
  // 注意：它不一定等同于 README 里的“下载说明页”，而是 Conveyor 生成的更新站点地址。
  site.base-url = "https://fortescarlet.github.io/StopBonus/downloads"

  // 若希望 `conveyor make site` 直接上传到 GitHub Pages，可启用：
  //
  // site.github.oauth-token = ${env.GITHUB_TOKEN}
  // site.github.pages-branch = gh-pages

  // -----------------------------
  // 签名（signing-key）
  // -----------------------------
  //
  // 用于签名更新与某些平台包（具体取决于你启用的格式与平台策略）。
  // 建议在 CI 中通过 `ci.conveyor.conf` 注入，避免把密钥写入仓库：
  //
  // signing-key = ${env.CONVEYOR_ROOT_KEY}

  // -----------------------------
  // 图标（icons）
  // -----------------------------
  //
  // Conveyor 会把源图标渲染出各平台所需的尺寸与格式。
  icons = icon.png

  // 如果你希望“渲染后的图标”也打进产物中（让应用运行时可从文件系统读取），可以额外加 inputs：
  //
  // windows.inputs += TASK/rendered-icons/windows
  // linux.inputs += TASK/rendered-icons/linux
  // mac.inputs += TASK/rendered-icons/macos

  // -----------------------------
  // 更新策略（updates）
  // -----------------------------
  //
  // aggressive：每次启动都检查更新（一般不建议默认启用）。
  // 其他策略按需选择；如不设置则使用默认策略。
  //
  // updates = aggressive

  // -----------------------------------------------------------------------------
  // 3.1 JVM 相关（app.jvm）
  // -----------------------------------------------------------------------------
  //
  // 注意：下列很多项会在 `printConveyorConfig` 的动态片段里出现，你可以在这里“覆盖/追加”。
  jvm {
    // GUI 应用入口 main class（Compose Desktop 通常是 `MainKt`）。
    //
    // gui.main-class = "MainKt"

    // JVM 参数：使用 `+=` 可以在现有参数基础上追加。
    //
    // options += "-Dfile.encoding=UTF-8"
    // options += "-XX:MaxRAMPercentage=50"

    // 系统属性（等价于 `-Dkey=value`）。
    //
    // system-properties {
    //   "some.key" = "some-value"
    // }

    // 平台差异化 JVM 参数（覆盖/追加）。
    //
    // windows.options += "-Dsome.path=C:\\\\foo\\\\bar"
    // linux.options += "-Dsome.path=/opt/foo/bar"
    // mac.options += "-Dsome.path=/Applications/Foo.app/Contents"
  }

  // -----------------------------------------------------------------------------
  // 3.2 Inputs（app.inputs / app.<platform>.*.inputs）
  // -----------------------------------------------------------------------------
  //
  // `app.inputs` 是应用打包输入（JAR/依赖/资源等）。
  // 本项目建议交由 Gradle 插件动态生成，避免把绝对路径写死在仓库里。
  //
  // inputs += "build/libs/your-app.jar"
  // inputs += "path/to/another.jar"

  // 各平台/架构的输入覆盖（常用于不同平台的 native runtime，例如 Skiko）。
  // 这些通常也由 Gradle 插件注入，下面仅示例结构：
  //
  // windows {
  //   amd64.inputs += "path/to/windows-x64-runtime.jar"
  //   aarch64.inputs += "path/to/windows-arm64-runtime.jar"
  // }
  //
  // mac {
  //   amd64.inputs += "path/to/macos-x64-runtime.jar"
  //   aarch64.inputs += "path/to/macos-arm64-runtime.jar"
  // }
  //
  // linux {
  //   // glibc/musl 等 ABI 也可进一步细分（示例为 glibc）：
  //   amd64.glibc.inputs += "path/to/linux-x64-glibc-runtime.jar"
  //   aarch64.glibc.inputs += "path/to/linux-arm64-glibc-runtime.jar"
  // }

  // -----------------------------------------------------------------------------
  // 3.3 Linux 桌面文件（app.linux.desktop-file）
  // -----------------------------------------------------------------------------
  //
  // Conveyor 可生成 .desktop 文件；常见字段位于 `"Desktop Entry"` 分组下。
  // Compose Desktop 插件默认会给 `StartupWMClass` 赋值（示例：MainKt）。
  //
  // linux.desktop-file."Desktop Entry" {
  //   Name = ${app.display-name}
  //   Comment = ${app.description}
  //   Categories = "Utility;"
  //   StartupWMClass = "MainKt"
  // }
}

